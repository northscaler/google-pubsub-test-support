'use strict';

const cp = require('child_process');

async function startGooglePubSub({
  port,
  projects
}) {
  projects = Array.from(new Set(projects));
  const env = projects.reduce((accum, project, index) => {
    accum[`PUBSUB_PROJECT${index + 1}`] = project;
    return accum;
  }, {});
  env.GOOGLE_PUBSUB_TEST_SUPPORT_PORT = port;
  console.log(cp.execFileSync(`${__dirname}/start-google-pubsub.sh`, [], env).toString());
}

module.exports = startGooglePubSub;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9tYWluL2dvb2dsZS1wdWJzdWIvc3RhcnQtZ29vZ2xlLXB1YnN1Yi5qcyJdLCJuYW1lcyI6WyJjcCIsInJlcXVpcmUiLCJzdGFydEdvb2dsZVB1YlN1YiIsInBvcnQiLCJwcm9qZWN0cyIsIkFycmF5IiwiZnJvbSIsIlNldCIsImVudiIsInJlZHVjZSIsImFjY3VtIiwicHJvamVjdCIsImluZGV4IiwiR09PR0xFX1BVQlNVQl9URVNUX1NVUFBPUlRfUE9SVCIsImNvbnNvbGUiLCJsb2ciLCJleGVjRmlsZVN5bmMiLCJfX2Rpcm5hbWUiLCJ0b1N0cmluZyIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBLE1BQU1BLEVBQUUsR0FBR0MsT0FBTyxDQUFDLGVBQUQsQ0FBbEI7O0FBRUEsZUFBZUMsaUJBQWYsQ0FBa0M7QUFBRUMsRUFBQUEsSUFBRjtBQUFRQyxFQUFBQTtBQUFSLENBQWxDLEVBQXNEO0FBQ3BEQSxFQUFBQSxRQUFRLEdBQUdDLEtBQUssQ0FBQ0MsSUFBTixDQUFXLElBQUlDLEdBQUosQ0FBUUgsUUFBUixDQUFYLENBQVg7QUFDQSxRQUFNSSxHQUFHLEdBQUdKLFFBQVEsQ0FBQ0ssTUFBVCxDQUFnQixDQUFDQyxLQUFELEVBQVFDLE9BQVIsRUFBaUJDLEtBQWpCLEtBQTJCO0FBQ3JERixJQUFBQSxLQUFLLENBQUUsaUJBQWdCRSxLQUFLLEdBQUcsQ0FBRSxFQUE1QixDQUFMLEdBQXNDRCxPQUF0QztBQUNBLFdBQU9ELEtBQVA7QUFDRCxHQUhXLEVBR1QsRUFIUyxDQUFaO0FBSUFGLEVBQUFBLEdBQUcsQ0FBQ0ssK0JBQUosR0FBc0NWLElBQXRDO0FBQ0FXLEVBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZZixFQUFFLENBQUNnQixZQUFILENBQWlCLEdBQUVDLFNBQVUseUJBQTdCLEVBQXVELEVBQXZELEVBQTJEVCxHQUEzRCxFQUFnRVUsUUFBaEUsRUFBWjtBQUNEOztBQUVEQyxNQUFNLENBQUNDLE9BQVAsR0FBaUJsQixpQkFBakIiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCdcblxuY29uc3QgY3AgPSByZXF1aXJlKCdjaGlsZF9wcm9jZXNzJylcblxuYXN5bmMgZnVuY3Rpb24gc3RhcnRHb29nbGVQdWJTdWIgKHsgcG9ydCwgcHJvamVjdHMgfSkge1xuICBwcm9qZWN0cyA9IEFycmF5LmZyb20obmV3IFNldChwcm9qZWN0cykpXG4gIGNvbnN0IGVudiA9IHByb2plY3RzLnJlZHVjZSgoYWNjdW0sIHByb2plY3QsIGluZGV4KSA9PiB7XG4gICAgYWNjdW1bYFBVQlNVQl9QUk9KRUNUJHtpbmRleCArIDF9YF0gPSBwcm9qZWN0XG4gICAgcmV0dXJuIGFjY3VtXG4gIH0sIHt9KVxuICBlbnYuR09PR0xFX1BVQlNVQl9URVNUX1NVUFBPUlRfUE9SVCA9IHBvcnRcbiAgY29uc29sZS5sb2coY3AuZXhlY0ZpbGVTeW5jKGAke19fZGlybmFtZX0vc3RhcnQtZ29vZ2xlLXB1YnN1Yi5zaGAsIFtdLCBlbnYpLnRvU3RyaW5nKCkpXG59XG5cbm1vZHVsZS5leHBvcnRzID0gc3RhcnRHb29nbGVQdWJTdWJcbiJdfQ==